<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="p-4">
<div class="container">
    <h2 th:text="${user.id == null} ? '–î–æ–±–∞–≤–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è' : '–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è'"></h2>

    <!-- –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è -->
    <form th:if="${user.id == null}" th:action="@{/admin/users}" method="post">
        <div class="mb-3">
            <label class="form-label">–õ–æ–≥–∏–Ω</label>
            <input type="text" name="username" class="form-control" th:value="${user.username}" required/>
        </div>

        <div class="mb-3">
            <label class="form-label">–ü–∞—Ä–æ–ª—å</label>
            <input type="password" name="password" class="form-control" required/>
        </div>

        <div class="mb-3">
            <label class="form-label">–†–æ–ª—å (–¥–æ–ª–∂–Ω–æ—Å—Ç—å)</label>
            <select name="roleName" class="form-select">
                <option th:each="r : ${roles}" th:value="${r.name}" th:text="${r.name}"></option>
            </select>
        </div>

        <button type="submit" class="btn btn-primary">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
        <a href="/admin/users" class="btn btn-secondary">–û—Ç–º–µ–Ω–∞</a>
    </form>


    <!-- –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è -->
    <form th:if="${user.id != null}" th:action="@{'/admin/users/' + ${user.id} + '/update'}" method="post">
        <div class="mb-3">
            <label class="form-label">–õ–æ–≥–∏–Ω</label>
            <input type="text" name="username" class="form-control" th:value="${user.username}" required/>
        </div>

        <div class="mb-3">
            <label class="form-label">–ü–∞—Ä–æ–ª—å</label>
            <input type="password" name="password" class="form-control" id="password" placeholder="–û—Å—Ç–∞–≤—å—Ç–µ –ø—É—Å—Ç—ã–º, —á—Ç–æ–±—ã –Ω–µ –º–µ–Ω—è—Ç—å"/>
            <div class="mt-1">
                <span class="toggle-password text-primary" style="cursor: pointer;" onclick="togglePassword()">üëÅ –ü–æ–∫–∞–∑–∞—Ç—å –ø–∞—Ä–æ–ª—å</span>
            </div>
        </div>

        <div class="mb-3">
            <label class="form-label">–†–æ–ª—å (–¥–æ–ª–∂–Ω–æ—Å—Ç—å)</label>
            <select name="roleName" class="form-select">
                <option th:each="r : ${roles}" th:value="${r.name}"
                        th:selected="${user.roles.contains(r)}"
                        th:text="${r.name}"></option>
            </select>
        </div>

        <button type="submit" class="btn btn-primary">–û–±–Ω–æ–≤–∏—Ç—å</button>
        <a href="/admin/users" class="btn btn-secondary">–û—Ç–º–µ–Ω–∞</a>
    </form>

    <script>
        function togglePassword() {
            const passwordInput = document.getElementById("password");
            const toggleText = document.querySelector(".toggle-password");
            if (passwordInput.type === "password") {
                passwordInput.type = "text";
                toggleText.textContent = "üôà –°–∫—Ä—ã—Ç—å –ø–∞—Ä–æ–ª—å";
            } else {
                passwordInput.type = "password";
                toggleText.textContent = "üëÅ –ü–æ–∫–∞–∑–∞—Ç—å –ø–∞—Ä–æ–ª—å";
            }
        }
    </script>

</div>
</body>
</html>
